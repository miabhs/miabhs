<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/templates/page.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <f:metadata>
        <ui:param name="title" value="Pencapaian Santri" />

        <ui:param name="viewPage" value="#{pencapaianSantriPage}" />
        <ui:include src="/WEB-INF/components/core/base/meta/page.xhtml"/>

        <ui:param name="dataView" value="#{viewPage.dataView}" />
        <ui:param name="filter" value="#{dataView.filter}" /> 
        <ui:param name="pager" value="#{dataView.pager}" />
        <ui:param name="contentId" value=":data-frm:#{dataView.name}" /> 
        <f:viewParam name="pageSize" value="#{pager.pageSize}" />
        <f:viewParam name="offset" value="#{pager.offset}" />

        <f:viewParam name="s" value="#{dataView.selections}" converter="PengajaranSantriListConverter" />
        
        <f:viewParam name="sn" value="#{filter.content.santri}" converter="SantriConverter" />
        <f:viewParam name="kp" value="#{filter.content.kelompokPengasuhan}" converter="KelompokPengasuhanConverter" />
        <f:viewParam name="fd" value="#{filter.content.fromDate}" converter="LocalDateConverter" />
        <f:viewParam name="td" value="#{filter.content.thruDate}" converter="LocalDateConverter" />
        <f:viewParam name="kb" value="#{filter.content.jenisKitab}" converter="JenisKitabConverter" />

    </f:metadata> 

    <ui:define name="styles">
        <style>
            .ui-selectonemenu-item-group {
                text-align: center;
                font-style: italic;
            }
            .ui-inputwrapper-filled input {
                width: 100%!important
            }
            .field {
                margin-bottom: 0;
            }
        </style>
    </ui:define>

    <ui:define name="module-menu">
        <ui:include src="/WEB-INF/components/app/pengajaran/module-menu.xhtml" />
    </ui:define>

    <ui:define name="crud-update"/>

    <ui:define name="filter">
        <div class="flex gap-2 flex-nowrap align-items-center flex-shrink-0">
            <p:outputLabel for="periode" value="Periode" />
            <h:panelGroup layout="block" id="periode" class="flex ui-inputgroup">
                <p:datePicker id="from-date" value="#{filter.content.fromDate}"
                              showTime="false"  size="7" 
                              pattern="dd/MM/yyyy" placeholder="Awal" >
                    <p:ajax listener="#{filter.doFilter}" 
                            oncomplete="refreshContent()" />
                </p:datePicker>                
                <h:panelGroup layout="block" styleClass="ui-inputgroup-addon" >
                    <p:outputLabel value="s.d" />
                </h:panelGroup>
                <p:datePicker id="thru-date" value="#{filter.content.thruDate}"
                              showTime="false" size="7"
                              locale="#{IslamicDateConverter.locale}"
                              placeholder="Akhir" >
                    <p:ajax listener="#{filter.doFilter}" 
                            oncomplete="refreshContent()" />
                </p:datePicker>
            </h:panelGroup>
        </div>
        <p:divider layout="vertical" />
        <div class="flex align-items-center gap-2">
            <p:outputLabel value="Kelompok" />
            <p:selectOneMenu value="#{filter.content.kelompokPengasuhan}" 
                             converter="KelompokPengasuhanConverter" 
                             filter="true" filterMatchMode="contains"
                             filterPlaceholder="Cari..."
                             autoWidth="false"  >                        
                <f:selectItem itemLabel="Semua" itemValue="#{null}" />
                <f:selectItems value="#{kelompokPengasuhanAltList.fetchedItems}" 
                               var="item" itemValue="#{item}" 
                               itemLabel="#{item.organization.name}" />
                <p:ajax listener="#{filter.doFilter}" 
                        oncomplete="refreshContent()" />
            </p:selectOneMenu>
        </div>
        <p:divider layout="vertical" />
        <div class="flex align-items-center gap-2">
            <p:outputLabel for="santri" value="Santri" />
            <p:selectOneMenu id="santri" value="#{filter.content.santri}"
                             converter="SantriConverter" 
                             filter="true" filterMatchMode="contains" 
                             filterPlaceholder="Cari..."
                             autoWidth="false"  >                        
                <f:selectItem itemLabel="Semua" itemValue="#{null}" />
                <f:selectItems value="#{santriList2.santriGroup}" />
                <p:ajax listener="#{filter.doFilter}" 
                        oncomplete="refreshContent()" />
            </p:selectOneMenu>
        </div>
    </ui:define>

    <ui:define name="content">
        <h:form id="data-frm" class="flex-grow-1 flex align-items-stretch">            
            <ui:include src="/WEB-INF/components/app/pengajaran/pengajaransantrilist.xhtml">
                <ui:param name="editable" value="true" />
                <ui:param name="selectListener" value=":tools-frm" />
            </ui:include>
        </h:form>
    </ui:define>

    <ui:define name="pager">
        <ui:include src="/WEB-INF/components/core/base/pager.xhtml">
            <ui:param name="pagerListener" value=":data-frm:#{dataView.name}" />2
        </ui:include>
    </ui:define>

</ui:composition>